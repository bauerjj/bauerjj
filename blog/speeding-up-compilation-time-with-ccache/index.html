<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.2.2 by Michael Rose
  Copyright 2017 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>            Speeding Up Native Compiling and Cross-Compiling Time with ccache      bauerjj.com      </title>




<meta name="description" content="It took me years to finally realize that I could greatly speed up compilation time using a utility called ccache.">




<meta name="author" content="Justin Bauer">

<meta property="og:locale" content="en">
<meta property="og:site_name" content="bauerjj.com">
<meta property="og:title" content="Speeding Up Native Compiling and Cross-Compiling Time with ccache">


  <link rel="canonical" href="https://bauerjj.github.io/blog/speeding-up-compilation-time-with-ccache/">
  <meta property="og:url" content="https://bauerjj.github.io/blog/speeding-up-compilation-time-with-ccache/">



  <meta property="og:description" content="It took me years to finally realize that I could greatly speed up compilation time using a utility called ccache.">





  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2017-04-13T01:03:00-07:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Justin Bauer",
      "url" : "https://bauerjj.github.io////",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="https://bauerjj.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="bauerjj.com Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="https://bauerjj.github.io/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->

<meta http-equiv="cleartype" content="on">
    <!-- start custom head snippets -->

<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->
  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="https://bauerjj.github.io/">bauerjj.com</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item"><a href="https://bauerjj.github.io/about/">About</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://bauerjj.github.io/year-archive/">Tech Posts</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://mcuhq.com">Microcontroller Stuff</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://bauerjj.github.io/linux-tips/">Linux Tips</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://bauerjj.github.io/stuff-to-do-in-phoenix/">Stuff to do in Phoenix, AZ</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://bauerjj.github.io/documentaries/">Documentaries</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://bauerjj.github.io/life-pro-tips/">Life Pro Tips</a></li>
          
            
            <li class="masthead__menu-item"><a href="https://bauerjj.github.io/links/">Web Links</a></li>
          
        </ul>
        <button><div class="navicon"></div></button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="http://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
          <a href="https://bauerjj.github.io/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        
        <li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
          <a href="https://bauerjj.github.io/categories#blog" itemprop="item"><span itemprop="name">Blog</span></a>
          <meta itemprop="position" content="2" />
        </li>
        <span class="sep">/</span>
      
    
      
      
        <li class="current">Speeding Up Native Compiling and Cross-Compiling Time with ccache</li>
      
    
  </ol>
</nav>
  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  

<div itemscope itemtype="http://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="https://bauerjj.github.io/assets/images/bio-photo.jpg" class="author__avatar" alt="Justin Bauer" itemprop="image">
      
    </div>
  

  <div class="author__content">
    <h3 class="author__name" itemprop="name">Justin Bauer</h3>
    
      <p class="author__bio" itemprop="description">
        Embedded software engineer in Tempe, Arizona. "Hey, it worked on my machine!" 
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> <span itemprop="name">Tempe, AZ</span>
        </li>
      

      
        <li>
          <a href="http://mcuhq.com" itemprop="url">
            <i class="fa fa-fw fa-chain" aria-hidden="true"></i> Website
          </a>
        </li>
      

      
        <li>
          <a href="mailto:justinjbauer1@gmail.com">
            <meta itemprop="email" content="justinjbauer1@gmail.com" />
            <i class="fa fa-fw fa-envelope-square" aria-hidden="true"></i> Email
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://www.linkedin.com/in/justin-bauer-a7a9ba116" itemprop="sameAs">
            <i class="fa fa-fw fa-linkedin-square" aria-hidden="true"></i> LinkedIn
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://github.com/bauerjj" itemprop="sameAs">
            <i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      
	  
	  
        <li>
          <a href="https://www.upwork.com/o/profiles/users/_~0143336a2b30982239/" itemprop="sameAs">
            <i class="fa fa-fw fa-briefcase" aria-hidden="true"></i> Upwork
          </a>
        </li>
      
	  

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fa fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Speeding Up Native Compiling and Cross-Compiling Time with ccache">
    <meta itemprop="description" content="It took me years to finally realize that I could greatly speed up compilation time using a utility called ccache.">
    <meta itemprop="datePublished" content="April 13, 2017">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Speeding Up Native Compiling and Cross-Compiling Time with ccache
</h1>
          
            <p class="page__meta"><i class="fa fa-clock-o" aria-hidden="true"></i> 




  3 minute read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        <p>It took me years to finally realize that I could greatly speed up compilation time using a utility called <code class="highlighter-rouge">ccache</code>.</p>

<aside class="sidebar__right">
<nav class="toc">
    <header><h4 class="nav__title"><i class="fa fa-file-text"></i> On This Page</h4></header>
<ul class="toc__menu" id="markdown-toc">
  <li><a href="#native-compiling" id="markdown-toc-native-compiling">Native Compiling</a></li>
  <li><a href="#cross-compiling" id="markdown-toc-cross-compiling">Cross-Compiling</a></li>
  <li><a href="#setting-up-qtcreator" id="markdown-toc-setting-up-qtcreator">Setting up QtCreator</a></li>
</ul>

  </nav>
</aside>

<p>It is essentially a wrapper around your compiler, most likely g++, that caches the compiled objects from your source and saves them in your home directory (<code class="highlighter-rouge">.ccache</code> folder) so that subsequent builds with the <em>identical environment settings</em> will use the cache. Not using it is pretty much wasting time. Sourcing an environment script that changes any compiler flags or targets that are different from the already compiled objects from the same source files in prior builds will inflict a “cache miss”.</p>

<p>To install: <code class="highlighter-rouge">sudo apt-get install ccache</code></p>

<p><code class="highlighter-rouge">ccache</code> includes the compiler name in the hash as shown in the <a href="http://ccache.samba.org/manual.html#_common_hashed_information">manual</a>, making it safe for multiple architectures to use <code class="highlighter-rouge">ccache</code>.</p>

<h2 id="native-compiling">Native Compiling</h2>

<p>In your <code class="highlighter-rouge">.bash_rc</code> file or similar, place: <code class="highlighter-rouge">export PATH=/usr/lib/ccache:$PATH</code></p>

<p>Run <code class="highlighter-rouge">which gcc</code> to ensure that it is pointing at ccache. The paths that show up first in the variable are parsed first - a “first come first served” situation.</p>

<p>To verify operation and see the cache grow in size, start compiling something and invoke the following:</p>
<div class="highlighter-rouge"><pre class="highlight"><code>jbauer@ad-dell:~$ watch -n 1 ccache -s

Every 1.0s: ccache -s               Thu Apr 13 14:32:22 2017

cache directory                     /home/jbauer/.ccache
primary config                      /home/jbauer/.ccache/ccache.conf
secondary config      (readonly)    /etc/ccache.conf
cache hit (direct)                    56
cache hit (preprocessed)               0
cache miss                          1991
called for link                      369
no input file                          2
files in cache                      4217
cache size                         962.5 MB
</code></pre>
</div>

<p>You can also just use this to print out the stats directly: <code class="highlighter-rouge">jbauer@ad-dell:~$ ccache -s</code></p>

<h2 id="cross-compiling">Cross-Compiling</h2>
<p>Similar methodology can be used to have your cross-compilers utilize <code class="highlighter-rouge">ccache</code>. I’m usually using Yocto, which creates an SDK for your target and contains an environment script that I can then <code class="highlighter-rouge">source</code> and begin compilation for the embedded target.</p>

<ol>
  <li>Install the Yocto supplied SDK after bitbaking it.</li>
  <li>Open your environment script and find the name of your cross-compiler. My location was: <code class="highlighter-rouge">/opt/poky/2.1.2/environment-setup-cortexa9hf-neon-poky-linux-gnueabi</code>. The compiler name is then found under the <code class="highlighter-rouge">export CC=</code> line.</li>
  <li>
    <p>Create two soft links in your <code class="highlighter-rouge">ccache</code> directory</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> $ cd /usr/lib/ccache
 $ ln -s /usr/bin/ccache arm-poky-linux-gnueabi-g++ 
 $ ln -s /usr/bin/ccache arm-poky-linux-gnueabi-gcc 
</code></pre>
    </div>
  </li>
  <li>
    <p>Re-open your environment script and prepend <code class="highlighter-rouge">/usr/lib/ccache</code> in the <code class="highlighter-rouge">PATH</code> variable. This ensures that your machine will first look in your <code class="highlighter-rouge">ccache</code> directory for the compilers. Omitting this step will require you to manually export the PATH variable after sourcing the script or else <code class="highlighter-rouge">ccache</code> will never do its job.</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> export PATH=/usr/lib/ccache:/opt/poky/2.1.2/sysroot/....
</code></pre>
    </div>
  </li>
  <li>
    <p>Verify your work</p>

    <div class="highlighter-rouge"><pre class="highlight"><code> $ ls -al
 lrwxrwxrwx 1 root root 16 Apr 13 13:25 arm-poky-linux-gnueabi-g++ -&gt; ../../bin/ccache
 lrwxrwxrwx 1 root root 16 Apr 13 13:25 arm-poky-linux-gnueabi-gcc -&gt; ../../bin/ccache
 lrwxrwxrwx 1 root root 16 Mar 21 12:24 c++ -&gt; ../../bin/ccache
 lrwxrwxrwx 1 root root 16 Mar 21 12:24 c89-gcc -&gt; ../../bin/ccache
 lrwxrwxrwx 1 root root 16 Mar 21 12:24 c99-gcc -&gt; ../../bin/ccache
 lrwxrwxrwx 1 root root 16 Mar 21 12:24 cc -&gt; ../../bin/ccache
 lrwxrwxrwx 1 root root 16 Mar 21 12:24 g++ -&gt; ../../bin/ccache
 lrwxrwxrwx 1 root root 16 Mar 21 12:24 g++-5 -&gt; ../../bin/ccache
 lrwxrwxrwx 1 root root 16 Mar 21 12:24 gcc -&gt; ../../bin/ccache
 lrwxrwxrwx 1 root root 16 Mar 21 12:24 gcc-4.8 -&gt; ../../bin/ccache
 lrwxrwxrwx 1 root root 16 Mar 21 12:24 gcc-5 -&gt; ../../bin/ccache
 lrwxrwxrwx 1 root root 16 Mar 21 12:24 x86_64-linux-gnu-g++ -&gt; ../../bin/ccache
 lrwxrwxrwx 1 root root 16 Mar 21 12:24 x86_64-linux-gnu-g++-5 -&gt; ../../bin/ccache
 lrwxrwxrwx 1 root root 16 Mar 21 12:24 x86_64-linux-gnu-gcc -&gt; ../../bin/ccache
 lrwxrwxrwx 1 root root 16 Mar 21 12:24 x86_64-linux-gnu-gcc-4.8 -&gt; ../../bin/ccache
 lrwxrwxrwx 1 root root 16 Mar 21 12:24 x86_64-linux-gnu-gcc-5 -&gt; ../../bin/ccache
</code></pre>
    </div>
  </li>
</ol>

<h2 id="setting-up-qtcreator">Setting up QtCreator</h2>
<p>You can utilize <code class="highlighter-rouge">ccache</code> inside of QtCreator by selecting your native and cross-compiler links inside of the <code class="highlighter-rouge">ccache</code> directory. Below shows two screenshots of setting up my cross-compiler. Notice how I had to manually locate both gcc and g++ and instruct Qt what they are targeting. Your paths will differ slightly since I have my project defined as “Armadillo” or “ado”.</p>

<p><img src="/assets/images/kit-overall.png" alt="QtCreator Cross-Compiler" /></p>

<p><img src="/assets/images/gcc-ccache.png" alt="QtCreator Cross-Compiler" /></p>

<p>Be sure to source your environment before launching QtCreator!</p>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fa fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="https://bauerjj.github.io/categories/#blog" class="page__taxonomy-item" rel="tag">blog</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Updated:</strong> <time datetime="2017-04-13T01:03:00-07:00">April 13, 2017</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Speeding Up Native Compiling and Cross-Compiling Time with ccache https://bauerjj.github.io/blog/speeding-up-compilation-time-with-ccache/" class="btn btn--twitter" title="Share on Twitter"><i class="fa fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https://bauerjj.github.io/blog/speeding-up-compilation-time-with-ccache/" class="btn btn--facebook" title="Share on Facebook"><i class="fa fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://plus.google.com/share?url=https://bauerjj.github.io/blog/speeding-up-compilation-time-with-ccache/" class="btn btn--google-plus" title="Share on Google Plus"><i class="fa fa-fw fa-google-plus" aria-hidden="true"></i><span> Google+</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://bauerjj.github.io/blog/speeding-up-compilation-time-with-ccache/" class="btn btn--linkedin" title="Share on LinkedIn"><i class="fa fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="https://bauerjj.github.io/blog/hackster-io-phoenix/" class="pagination--pager" title="Hackster.io Phoenix - What Happened?
">Previous</a>
    
    
      <a href="https://bauerjj.github.io/blog/resizing-main-parition-using-gparted-in-a-vm/" class="pagination--pager" title="Resizing Main Partition Using gparted in a VM
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
    
    
      <li><a href="http://github.com/bauerjj"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    <li><a href="https://bauerjj.github.io/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2017 Justin Bauer. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; modified version of <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a> theme.</div>
      </footer>
    </div>

    <script src="https://bauerjj.github.io/assets/js/main.min.js"></script>





  </body>
</html>
